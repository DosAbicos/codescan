{"dependencies":[{"name":"../dependencies/WorkletsProxy","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":62,"index":62}}],"key":"5OGlOxUAFMMCpeUYvtYQCOkE3Aw=","exportNames":["*"],"imports":1}},{"name":"./FrameProcessorsUnavailableError","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":63},"end":{"line":2,"column":84,"index":147}}],"key":"gTwmIrM8qVRe40xt7F4ceNy7iow=","exportNames":["*"],"imports":1}},{"name":"./throwErrorOnJS","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":148},"end":{"line":3,"column":50,"index":198}}],"key":"RpaQ/BrKCPOWCzy3Ib+nIZOtDwU=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"runAsync\", {\n    enumerable: true,\n    get: function () {\n      return runAsync;\n    }\n  });\n  var _dependenciesWorkletsProxy = require(_dependencyMap[0], \"../dependencies/WorkletsProxy\");\n  var _FrameProcessorsUnavailableError = require(_dependencyMap[1], \"./FrameProcessorsUnavailableError\");\n  var _throwErrorOnJS = require(_dependencyMap[2], \"./throwErrorOnJS\");\n  /**\n   * A synchronized Shared Value to indicate whether the async context is currently executing\n   */\n  let isAsyncContextBusy;\n  /**\n   * Runs the given function on the async context, and sets {@linkcode isAsyncContextBusy} to false after it finished executing.\n   */\n  let runOnAsyncContext;\n  const _worklet_17335875081787_init_data = {\n    code: \"function reactNativeVisionCamera_runAsyncJs1(frame,func){const{throwErrorOnJS,isAsyncContextBusy}=this.__closure;try{func();}catch(e){throwErrorOnJS(e);}finally{const internal=frame;internal.decrementRefCount();isAsyncContextBusy.value=false;}}\",\n    location: \"/app/frontend/node_modules/react-native-vision-camera/lib/module/frame-processors/runAsync.js\",\n    sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"reactNativeVisionCamera_runAsyncJs1\\\",\\\"frame\\\",\\\"func\\\",\\\"throwErrorOnJS\\\",\\\"isAsyncContextBusy\\\",\\\"__closure\\\",\\\"e\\\",\\\"internal\\\",\\\"decrementRefCount\\\",\\\"value\\\"],\\\"sources\\\":[\\\"/app/frontend/node_modules/react-native-vision-camera/lib/module/frame-processors/runAsync.js\\\"],\\\"mappings\\\":\\\"AAgBkD,QAAC,CAAAA,mCAAgBA,CAAAC,KAAA,CAAAC,IAAA,QAAAC,cAAA,CAAAC,kBAAA,OAAAC,SAAA,CAG/D,GAAI,CAEFH,IAAI,CAAC,CAAC,CACR,CAAE,MAAOI,CAAC,CAAE,CAEVH,cAAc,CAACG,CAAC,CAAC,CACnB,CAAC,OAAS,CAER,KAAM,CAAAC,QAAQ,CAAGN,KAAK,CACtBM,QAAQ,CAACC,iBAAiB,CAAC,CAAC,CAG5BJ,kBAAkB,CAACK,KAAK,CAAG,KAAK,CAClC,CACF\\\",\\\"ignoreList\\\":[]}\"\n  };\n  try {\n    const Worklets = _dependenciesWorkletsProxy.WorkletsProxy.Worklets;\n    isAsyncContextBusy = Worklets.createSharedValue(false);\n    const asyncContext = Worklets.createContext('VisionCamera.async');\n    runOnAsyncContext = asyncContext.createRunAsync(function reactNativeVisionCamera_runAsyncJs1Factory({\n      _worklet_17335875081787_init_data,\n      throwErrorOnJS,\n      isAsyncContextBusy\n    }) {\n      const _e = [new global.Error(), -3, -27];\n      const reactNativeVisionCamera_runAsyncJs1 = function (frame, func) {\n        try {\n          // Call long-running function\n          func();\n        } catch (e) {\n          // Re-throw error on JS Thread\n          throwErrorOnJS(e);\n        } finally {\n          // Potentially delete Frame if we were the last ref\n          const internal = frame;\n          internal.decrementRefCount();\n\n          // free up async context again, new calls can be made\n          isAsyncContextBusy.value = false;\n        }\n      };\n      reactNativeVisionCamera_runAsyncJs1.__closure = {\n        throwErrorOnJS,\n        isAsyncContextBusy\n      };\n      reactNativeVisionCamera_runAsyncJs1.__workletHash = 17335875081787;\n      reactNativeVisionCamera_runAsyncJs1.__pluginVersion = \"0.7.1\";\n      reactNativeVisionCamera_runAsyncJs1.__initData = _worklet_17335875081787_init_data;\n      reactNativeVisionCamera_runAsyncJs1.__stackDetails = _e;\n      return reactNativeVisionCamera_runAsyncJs1;\n    }({\n      _worklet_17335875081787_init_data,\n      throwErrorOnJS: _throwErrorOnJS.throwErrorOnJS,\n      isAsyncContextBusy\n    }));\n  } catch (e) {\n    // react-native-worklets-core is not installed!\n    // Just use dummy implementations that will throw when the user tries to use Frame Processors.\n    isAsyncContextBusy = {\n      value: false\n    };\n    runOnAsyncContext = () => {\n      throw new _FrameProcessorsUnavailableError.FrameProcessorsUnavailableError(e);\n    };\n  }\n\n  /**\n   * Runs the given {@linkcode func} asynchronously on a separate thread,\n   * allowing the Frame Processor to continue executing without dropping a Frame.\n   *\n   * Only one {@linkcode runAsync} call will execute at the same time,\n   * so {@linkcode runAsync} is **not parallel**, **but asynchronous**.\n   *\n   *\n   * For example, if your Camera is running at 60 FPS (16ms per frame), and a\n   * heavy ML face detection Frame Processor Plugin takes 500ms to execute,\n   * you have two options:\n   * - Run the plugin normally (synchronously in `useFrameProcessor`)\n   * but drop a lot of Frames, as we can only run at 2 FPS (500ms per frame)\n   * - Call the plugin inside {@linkcode runAsync} to allow the Camera to still\n   * run at 60 FPS, but offload the heavy ML face detection plugin to the\n   * asynchronous context, where it will run at 2 FPS.\n   *\n   * @note {@linkcode runAsync} cannot be used to draw to a Frame in a Skia Frame Processor.\n   * @param frame The current Frame of the Frame Processor.\n   * @param func The function to execute.\n   * @worklet\n   * @example\n   *\n   * ```ts\n   * const frameProcessor = useFrameProcessor((frame) => {\n   *   'worklet'\n   *   console.log('New Frame arrived!')\n   *\n   *   runAsync(frame, () => {\n   *     'worklet'\n   *     const faces = detectFaces(frame)\n   *     const face = faces[0]\n   *     console.log(`Detected a new face: ${face}`)\n   *   })\n   * })\n   * ```\n   */\n  const _worklet_13768994699248_init_data = {\n    code: \"function runAsync_reactNativeVisionCamera_runAsyncJs2(frame,func){const{isAsyncContextBusy,runOnAsyncContext}=this.__closure;if(isAsyncContextBusy.value){return;}const internal=frame;internal.incrementRefCount();isAsyncContextBusy.value=true;runOnAsyncContext(frame,func);}\",\n    location: \"/app/frontend/node_modules/react-native-vision-camera/lib/module/frame-processors/runAsync.js\",\n    sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"runAsync_reactNativeVisionCamera_runAsyncJs2\\\",\\\"frame\\\",\\\"func\\\",\\\"isAsyncContextBusy\\\",\\\"runOnAsyncContext\\\",\\\"__closure\\\",\\\"value\\\",\\\"internal\\\",\\\"incrementRefCount\\\"],\\\"sources\\\":[\\\"/app/frontend/node_modules/react-native-vision-camera/lib/module/frame-processors/runAsync.js\\\"],\\\"mappings\\\":\\\"AAkFO,SAAAA,4CAA+BA,CAAAC,KAAA,CAAAC,IAAA,QAAAC,kBAAA,CAAAC,iBAAA,OAAAC,SAAA,CAGpC,GAAIF,kBAAkB,CAACG,KAAK,CAAE,CAG5B,OACF,CAGA,KAAM,CAAAC,QAAQ,CAAGN,KAAK,CACtBM,QAAQ,CAACC,iBAAiB,CAAC,CAAC,CAC5BL,kBAAkB,CAACG,KAAK,CAAG,IAAI,CAG/BF,iBAAiB,CAACH,KAAK,CAAEC,IAAI,CAAC,CAChC\\\",\\\"ignoreList\\\":[]}\"\n  };\n  const runAsync = function runAsync_reactNativeVisionCamera_runAsyncJs2Factory({\n    _worklet_13768994699248_init_data,\n    isAsyncContextBusy,\n    runOnAsyncContext\n  }) {\n    const _e = [new global.Error(), -3, -27];\n    const runAsync = function (frame, func) {\n      if (isAsyncContextBusy.value) {\n        // async context is currently busy, we cannot schedule new work in time.\n        // drop this frame/runAsync call.\n        return;\n      }\n\n      // Increment ref count by one\n      const internal = frame;\n      internal.incrementRefCount();\n      isAsyncContextBusy.value = true;\n\n      // Call in separate background context\n      runOnAsyncContext(frame, func);\n    };\n    runAsync.__closure = {\n      isAsyncContextBusy,\n      runOnAsyncContext\n    };\n    runAsync.__workletHash = 13768994699248;\n    runAsync.__pluginVersion = \"0.7.1\";\n    runAsync.__initData = _worklet_13768994699248_init_data;\n    runAsync.__stackDetails = _e;\n    return runAsync;\n  }({\n    _worklet_13768994699248_init_data,\n    isAsyncContextBusy,\n    runOnAsyncContext\n  });\n});","lineCount":157,"map":[[7,2,83,0,"Object"],[7,8,83,0],[7,9,83,0,"defineProperty"],[7,23,83,0],[7,24,83,0,"exports"],[7,31,83,0],[8,4,83,0,"enumerable"],[8,14,83,0],[9,4,83,0,"get"],[9,7,83,0],[9,18,83,0,"get"],[9,19,83,0],[10,6,83,0],[10,13,83,0,"runAsync"],[10,21,83,0],[11,4,83,0],[12,2,83,0],[13,2,1,0],[13,6,1,0,"_dependenciesWorkletsProxy"],[13,32,1,0],[13,35,1,0,"require"],[13,42,1,0],[13,43,1,0,"_dependencyMap"],[13,57,1,0],[14,2,2,0],[14,6,2,0,"_FrameProcessorsUnavailableError"],[14,38,2,0],[14,41,2,0,"require"],[14,48,2,0],[14,49,2,0,"_dependencyMap"],[14,63,2,0],[15,2,3,0],[15,6,3,0,"_throwErrorOnJS"],[15,21,3,0],[15,24,3,0,"require"],[15,31,3,0],[15,32,3,0,"_dependencyMap"],[15,46,3,0],[16,2,5,0],[17,0,6,0],[18,0,7,0],[19,2,8,0],[19,6,8,4,"isAsyncContextBusy"],[19,24,8,22],[20,2,9,0],[21,0,10,0],[22,0,11,0],[23,2,12,0],[23,6,12,4,"runOnAsyncContext"],[23,23,12,21],[24,2,12,22],[24,8,12,22,"_worklet_17335875081787_init_data"],[24,41,12,22],[25,4,12,22,"code"],[25,8,12,22],[26,4,12,22,"location"],[26,12,12,22],[27,4,12,22,"sourceMap"],[27,13,12,22],[28,2,12,22],[29,2,13,0],[29,6,13,4],[30,4,14,2],[30,10,14,8,"Worklets"],[30,18,14,16],[30,21,14,19,"WorkletsProxy"],[30,47,14,32],[30,48,14,32,"WorkletsProxy"],[30,61,14,32],[30,62,14,33,"Worklets"],[30,70,14,41],[31,4,15,2,"isAsyncContextBusy"],[31,22,15,20],[31,25,15,23,"Worklets"],[31,33,15,31],[31,34,15,32,"createSharedValue"],[31,51,15,49],[31,52,15,50],[31,57,15,55],[31,58,15,56],[32,4,16,2],[32,10,16,8,"asyncContext"],[32,22,16,20],[32,25,16,23,"Worklets"],[32,33,16,31],[32,34,16,32,"createContext"],[32,47,16,45],[32,48,16,46],[32,68,16,66],[32,69,16,67],[33,4,17,2,"runOnAsyncContext"],[33,21,17,19],[33,24,17,22,"asyncContext"],[33,36,17,34],[33,37,17,35,"createRunAsync"],[33,51,17,49],[33,52,17,50],[33,61,17,50,"reactNativeVisionCamera_runAsyncJs1Factory"],[33,104,17,50],[34,6,17,50,"_worklet_17335875081787_init_data"],[34,39,17,50],[35,6,25,6,"throwErrorOnJS"],[35,20,25,20],[36,6,32,6,"isAsyncContextBusy"],[37,4,32,24],[38,6,32,24],[38,12,32,24,"_e"],[38,14,32,24],[38,22,32,24,"global"],[38,28,32,24],[38,29,32,24,"Error"],[38,34,32,24],[39,6,32,24],[39,12,32,24,"reactNativeVisionCamera_runAsyncJs1"],[39,47,32,24],[39,59,32,24,"reactNativeVisionCamera_runAsyncJs1"],[39,60,17,51,"frame"],[39,65,17,56],[39,67,17,58,"func"],[39,71,17,62],[39,73,17,67],[40,8,20,4],[40,12,20,8],[41,10,21,6],[42,10,22,6,"func"],[42,14,22,10],[42,15,22,11],[42,16,22,12],[43,8,23,4],[43,9,23,5],[43,10,23,6],[43,17,23,13,"e"],[43,18,23,14],[43,20,23,16],[44,10,24,6],[45,10,25,6,"throwErrorOnJS"],[45,24,25,20],[45,25,25,21,"e"],[45,26,25,22],[45,27,25,23],[46,8,26,4],[46,9,26,5],[46,18,26,14],[47,10,27,6],[48,10,28,6],[48,16,28,12,"internal"],[48,24,28,20],[48,27,28,23,"frame"],[48,32,28,28],[49,10,29,6,"internal"],[49,18,29,14],[49,19,29,15,"decrementRefCount"],[49,36,29,32],[49,37,29,33],[49,38,29,34],[51,10,31,6],[52,10,32,6,"isAsyncContextBusy"],[52,28,32,24],[52,29,32,25,"value"],[52,34,32,30],[52,37,32,33],[52,42,32,38],[53,8,33,4],[54,6,34,2],[54,7,34,3],[55,6,34,3,"reactNativeVisionCamera_runAsyncJs1"],[55,41,34,3],[55,42,34,3,"__closure"],[55,51,34,3],[56,8,25,6,"throwErrorOnJS"],[56,22,25,20],[57,8,32,6,"isAsyncContextBusy"],[58,6,32,24],[59,6,32,24,"reactNativeVisionCamera_runAsyncJs1"],[59,41,32,24],[59,42,32,24,"__workletHash"],[59,55,32,24],[60,6,32,24,"reactNativeVisionCamera_runAsyncJs1"],[60,41,32,24],[60,42,32,24,"__pluginVersion"],[60,57,32,24],[61,6,32,24,"reactNativeVisionCamera_runAsyncJs1"],[61,41,32,24],[61,42,32,24,"__initData"],[61,52,32,24],[61,55,32,24,"_worklet_17335875081787_init_data"],[61,88,32,24],[62,6,32,24,"reactNativeVisionCamera_runAsyncJs1"],[62,41,32,24],[62,42,32,24,"__stackDetails"],[62,56,32,24],[62,59,32,24,"_e"],[62,61,32,24],[63,6,32,24],[63,13,32,24,"reactNativeVisionCamera_runAsyncJs1"],[63,48,32,24],[64,4,32,24],[64,5,17,50],[65,6,17,50,"_worklet_17335875081787_init_data"],[65,39,17,50],[66,6,25,6,"throwErrorOnJS"],[66,20,25,20],[66,22,25,6,"throwErrorOnJS"],[66,37,25,20],[66,38,25,20,"throwErrorOnJS"],[66,52,25,20],[67,6,32,6,"isAsyncContextBusy"],[68,4,32,24],[68,6,34,3],[68,7,34,4],[69,2,35,0],[69,3,35,1],[69,4,35,2],[69,11,35,9,"e"],[69,12,35,10],[69,14,35,12],[70,4,36,2],[71,4,37,2],[72,4,38,2,"isAsyncContextBusy"],[72,22,38,20],[72,25,38,23],[73,6,39,4,"value"],[73,11,39,9],[73,13,39,11],[74,4,40,2],[74,5,40,3],[75,4,41,2,"runOnAsyncContext"],[75,21,41,19],[75,24,41,22,"runOnAsyncContext"],[75,25,41,22],[75,30,41,28],[76,6,42,4],[76,12,42,10],[76,16,42,14,"FrameProcessorsUnavailableError"],[76,48,42,45],[76,49,42,45,"FrameProcessorsUnavailableError"],[76,80,42,45],[76,81,42,46,"e"],[76,82,42,47],[76,83,42,48],[77,4,43,2],[77,5,43,3],[78,2,44,0],[80,2,46,0],[81,0,47,0],[82,0,48,0],[83,0,49,0],[84,0,50,0],[85,0,51,0],[86,0,52,0],[87,0,53,0],[88,0,54,0],[89,0,55,0],[90,0,56,0],[91,0,57,0],[92,0,58,0],[93,0,59,0],[94,0,60,0],[95,0,61,0],[96,0,62,0],[97,0,63,0],[98,0,64,0],[99,0,65,0],[100,0,66,0],[101,0,67,0],[102,0,68,0],[103,0,69,0],[104,0,70,0],[105,0,71,0],[106,0,72,0],[107,0,73,0],[108,0,74,0],[109,0,75,0],[110,0,76,0],[111,0,77,0],[112,0,78,0],[113,0,79,0],[114,0,80,0],[115,0,81,0],[116,0,82,0],[117,2,46,0],[117,8,46,0,"_worklet_13768994699248_init_data"],[117,41,46,0],[118,4,46,0,"code"],[118,8,46,0],[119,4,46,0,"location"],[119,12,46,0],[120,4,46,0,"sourceMap"],[120,13,46,0],[121,2,46,0],[122,2,46,0],[122,8,46,0,"runAsync"],[122,16,46,0],[122,19,83,7],[122,28,83,7,"runAsync_reactNativeVisionCamera_runAsyncJs2Factory"],[122,80,83,7],[123,4,83,7,"_worklet_13768994699248_init_data"],[123,37,83,7],[124,4,86,6,"isAsyncContextBusy"],[124,22,86,24],[125,4,98,2,"runOnAsyncContext"],[126,2,98,19],[127,4,98,19],[127,10,98,19,"_e"],[127,12,98,19],[127,20,98,19,"global"],[127,26,98,19],[127,27,98,19,"Error"],[127,32,98,19],[128,4,98,19],[128,10,98,19,"runAsync"],[128,18,98,19],[128,30,98,19,"runAsync"],[128,31,83,25,"frame"],[128,36,83,30],[128,38,83,32,"func"],[128,42,83,36],[128,44,83,38],[129,6,86,2],[129,10,86,6,"isAsyncContextBusy"],[129,28,86,24],[129,29,86,25,"value"],[129,34,86,30],[129,36,86,32],[130,8,87,4],[131,8,88,4],[132,8,89,4],[133,6,90,2],[135,6,92,2],[136,6,93,2],[136,12,93,8,"internal"],[136,20,93,16],[136,23,93,19,"frame"],[136,28,93,24],[137,6,94,2,"internal"],[137,14,94,10],[137,15,94,11,"incrementRefCount"],[137,32,94,28],[137,33,94,29],[137,34,94,30],[138,6,95,2,"isAsyncContextBusy"],[138,24,95,20],[138,25,95,21,"value"],[138,30,95,26],[138,33,95,29],[138,37,95,33],[140,6,97,2],[141,6,98,2,"runOnAsyncContext"],[141,23,98,19],[141,24,98,20,"frame"],[141,29,98,25],[141,31,98,27,"func"],[141,35,98,31],[141,36,98,32],[142,4,99,0],[142,5,99,1],[143,4,99,1,"runAsync"],[143,12,99,1],[143,13,99,1,"__closure"],[143,22,99,1],[144,6,86,6,"isAsyncContextBusy"],[144,24,86,24],[145,6,98,2,"runOnAsyncContext"],[146,4,98,19],[147,4,98,19,"runAsync"],[147,12,98,19],[147,13,98,19,"__workletHash"],[147,26,98,19],[148,4,98,19,"runAsync"],[148,12,98,19],[148,13,98,19,"__pluginVersion"],[148,28,98,19],[149,4,98,19,"runAsync"],[149,12,98,19],[149,13,98,19,"__initData"],[149,23,98,19],[149,26,98,19,"_worklet_13768994699248_init_data"],[149,59,98,19],[150,4,98,19,"runAsync"],[150,12,98,19],[150,13,98,19,"__stackDetails"],[150,27,98,19],[150,30,98,19,"_e"],[150,32,98,19],[151,4,98,19],[151,11,98,19,"runAsync"],[151,19,98,19],[152,2,98,19],[152,3,83,7],[153,4,83,7,"_worklet_13768994699248_init_data"],[153,37,83,7],[154,4,86,6,"isAsyncContextBusy"],[154,22,86,24],[155,4,98,2,"runOnAsyncContext"],[156,2,98,19],[157,0,98,19],[157,3]],"functionMap":{"names":["<global>","asyncContext.createRunAsync$argument_0","runOnAsyncContext","runAsync"],"mappings":"AAA;kDCgB;GDiB;sBEO;GFE;OGwC;CHgB"},"hasCjsExports":false},"type":"js/module"}]}