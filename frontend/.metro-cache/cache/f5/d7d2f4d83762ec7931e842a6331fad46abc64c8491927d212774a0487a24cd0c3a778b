{"dependencies":[{"name":"../dependencies/WorkletsProxy","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":21,"index":130},"end":{"line":7,"column":61,"index":170}}],"key":"5i1rEhCv+YOz7EImowzwFcR4T4A=","exportNames":["*"],"imports":1}},{"name":"./FrameProcessorsUnavailableError","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":8,"column":39,"index":211},"end":{"line":8,"column":83,"index":255}}],"key":"OJsVqJTQyEgOCJhejOnxd4h1UlM=","exportNames":["*"],"imports":1}},{"name":"./throwErrorOnJS","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":9,"column":22,"index":279},"end":{"line":9,"column":49,"index":306}}],"key":"jZBEYCisF2YZxlHWvqCZx3VF08I=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.runAsync = runAsync;\n  var _WorkletsProxy = require(_dependencyMap[0], \"../dependencies/WorkletsProxy\");\n  var _FrameProcessorsUnavailableError = require(_dependencyMap[1], \"./FrameProcessorsUnavailableError\");\n  var _throwErrorOnJS = require(_dependencyMap[2], \"./throwErrorOnJS\");\n  /**\n   * A synchronized Shared Value to indicate whether the async context is currently executing\n   */\n  let isAsyncContextBusy;\n  /**\n   * Runs the given function on the async context, and sets {@linkcode isAsyncContextBusy} to false after it finished executing.\n   */\n  let runOnAsyncContext;\n  const _worklet_14389502829438_init_data = {\n    code: \"function reactNativeVisionCamera_runAsyncJs1(frame,func){const{_throwErrorOnJS,isAsyncContextBusy}=this.__closure;try{func();}catch(e){(0,_throwErrorOnJS.throwErrorOnJS)(e);}finally{const internal=frame;internal.decrementRefCount();isAsyncContextBusy.value=false;}}\",\n    location: \"/app/frontend/node_modules/react-native-vision-camera/lib/commonjs/frame-processors/runAsync.js\",\n    sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"reactNativeVisionCamera_runAsyncJs1\\\",\\\"frame\\\",\\\"func\\\",\\\"_throwErrorOnJS\\\",\\\"isAsyncContextBusy\\\",\\\"__closure\\\",\\\"e\\\",\\\"throwErrorOnJS\\\",\\\"internal\\\",\\\"decrementRefCount\\\",\\\"value\\\"],\\\"sources\\\":[\\\"/app/frontend/node_modules/react-native-vision-camera/lib/commonjs/frame-processors/runAsync.js\\\"],\\\"mappings\\\":\\\"AAqBkD,QAAC,CAAAA,mCAAgBA,CAAAC,KAAA,CAAAC,IAAA,QAAAC,eAAA,CAAAC,kBAAA,OAAAC,SAAA,CAG/D,GAAI,CAEFH,IAAI,CAAC,CAAC,CACR,CAAE,MAAOI,CAAC,CAAE,CAEV,CAAC,CAAC,CAAEH,eAAe,CAACI,cAAc,EAAED,CAAC,CAAC,CACxC,CAAC,OAAS,CAER,KAAM,CAAAE,QAAQ,CAAGP,KAAK,CACtBO,QAAQ,CAACC,iBAAiB,CAAC,CAAC,CAG5BL,kBAAkB,CAACM,KAAK,CAAG,KAAK,CAClC,CACF\\\",\\\"ignoreList\\\":[]}\"\n  };\n  try {\n    const Worklets = _WorkletsProxy.WorkletsProxy.Worklets;\n    isAsyncContextBusy = Worklets.createSharedValue(false);\n    const asyncContext = Worklets.createContext('VisionCamera.async');\n    runOnAsyncContext = asyncContext.createRunAsync(function reactNativeVisionCamera_runAsyncJs1Factory({\n      _worklet_14389502829438_init_data,\n      _throwErrorOnJS,\n      isAsyncContextBusy\n    }) {\n      const _e = [new global.Error(), -3, -27];\n      const reactNativeVisionCamera_runAsyncJs1 = function (frame, func) {\n        try {\n          // Call long-running function\n          func();\n        } catch (e) {\n          // Re-throw error on JS Thread\n          (0, _throwErrorOnJS.throwErrorOnJS)(e);\n        } finally {\n          // Potentially delete Frame if we were the last ref\n          const internal = frame;\n          internal.decrementRefCount();\n\n          // free up async context again, new calls can be made\n          isAsyncContextBusy.value = false;\n        }\n      };\n      reactNativeVisionCamera_runAsyncJs1.__closure = {\n        _throwErrorOnJS,\n        isAsyncContextBusy\n      };\n      reactNativeVisionCamera_runAsyncJs1.__workletHash = 14389502829438;\n      reactNativeVisionCamera_runAsyncJs1.__pluginVersion = \"0.7.1\";\n      reactNativeVisionCamera_runAsyncJs1.__initData = _worklet_14389502829438_init_data;\n      reactNativeVisionCamera_runAsyncJs1.__stackDetails = _e;\n      return reactNativeVisionCamera_runAsyncJs1;\n    }({\n      _worklet_14389502829438_init_data,\n      _throwErrorOnJS,\n      isAsyncContextBusy\n    }));\n  } catch (e) {\n    // react-native-worklets-core is not installed!\n    // Just use dummy implementations that will throw when the user tries to use Frame Processors.\n    isAsyncContextBusy = {\n      value: false\n    };\n    runOnAsyncContext = () => {\n      throw new _FrameProcessorsUnavailableError.FrameProcessorsUnavailableError(e);\n    };\n  }\n\n  /**\n   * Runs the given {@linkcode func} asynchronously on a separate thread,\n   * allowing the Frame Processor to continue executing without dropping a Frame.\n   *\n   * Only one {@linkcode runAsync} call will execute at the same time,\n   * so {@linkcode runAsync} is **not parallel**, **but asynchronous**.\n   *\n   *\n   * For example, if your Camera is running at 60 FPS (16ms per frame), and a\n   * heavy ML face detection Frame Processor Plugin takes 500ms to execute,\n   * you have two options:\n   * - Run the plugin normally (synchronously in `useFrameProcessor`)\n   * but drop a lot of Frames, as we can only run at 2 FPS (500ms per frame)\n   * - Call the plugin inside {@linkcode runAsync} to allow the Camera to still\n   * run at 60 FPS, but offload the heavy ML face detection plugin to the\n   * asynchronous context, where it will run at 2 FPS.\n   *\n   * @note {@linkcode runAsync} cannot be used to draw to a Frame in a Skia Frame Processor.\n   * @param frame The current Frame of the Frame Processor.\n   * @param func The function to execute.\n   * @worklet\n   * @example\n   *\n   * ```ts\n   * const frameProcessor = useFrameProcessor((frame) => {\n   *   'worklet'\n   *   console.log('New Frame arrived!')\n   *\n   *   runAsync(frame, () => {\n   *     'worklet'\n   *     const faces = detectFaces(frame)\n   *     const face = faces[0]\n   *     console.log(`Detected a new face: ${face}`)\n   *   })\n   * })\n   * ```\n   */\n  const _worklet_13768994699248_init_data = {\n    code: \"function runAsync_reactNativeVisionCamera_runAsyncJs2(frame,func){const{isAsyncContextBusy,runOnAsyncContext}=this.__closure;if(isAsyncContextBusy.value){return;}const internal=frame;internal.incrementRefCount();isAsyncContextBusy.value=true;runOnAsyncContext(frame,func);}\",\n    location: \"/app/frontend/node_modules/react-native-vision-camera/lib/commonjs/frame-processors/runAsync.js\",\n    sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"runAsync_reactNativeVisionCamera_runAsyncJs2\\\",\\\"frame\\\",\\\"func\\\",\\\"isAsyncContextBusy\\\",\\\"runOnAsyncContext\\\",\\\"__closure\\\",\\\"value\\\",\\\"internal\\\",\\\"incrementRefCount\\\"],\\\"sources\\\":[\\\"/app/frontend/node_modules/react-native-vision-camera/lib/commonjs/frame-processors/runAsync.js\\\"],\\\"mappings\\\":\\\"AAkDA,SAAAA,6CAAAC,KAAA,CAAAC,IAAA,QAAAC,kBAAA,CAAAC,iBAAA,OAAAC,SAAA,IAAAF,kBAAA,CAAAG,KAAA,EAGA,OACA,CAGA,MAAAC,QAAA,CAAAN,KAAA,CACAM,QAAA,CAAAC,iBAAA,GACAL,kBAAA,CAAAG,KAAA,MAGAF,iBAAA,CAAAH,KAAA,CAAAC,IAAA,EACA\\\",\\\"ignoreList\\\":[]}\"\n  };\n  const runAsync = function runAsync_reactNativeVisionCamera_runAsyncJs2Factory({\n    _worklet_13768994699248_init_data,\n    isAsyncContextBusy,\n    runOnAsyncContext\n  }) {\n    const _e = [new global.Error(), -3, -27];\n    const runAsync = function (frame, func) {\n      if (isAsyncContextBusy.value) {\n        // async context is currently busy, we cannot schedule new work in time.\n        // drop this frame/runAsync call.\n        return;\n      }\n\n      // Increment ref count by one\n      const internal = frame;\n      internal.incrementRefCount();\n      isAsyncContextBusy.value = true;\n\n      // Call in separate background context\n      runOnAsyncContext(frame, func);\n    };\n    runAsync.__closure = {\n      isAsyncContextBusy,\n      runOnAsyncContext\n    };\n    runAsync.__workletHash = 13768994699248;\n    runAsync.__pluginVersion = \"0.7.1\";\n    runAsync.__initData = _worklet_13768994699248_init_data;\n    runAsync.__stackDetails = _e;\n    return runAsync;\n  }({\n    _worklet_13768994699248_init_data,\n    isAsyncContextBusy,\n    runOnAsyncContext\n  });\n});","lineCount":152,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0,"Object"],[4,8,3,6],[4,9,3,7,"defineProperty"],[4,23,3,21],[4,24,3,22,"exports"],[4,31,3,29],[4,33,3,31],[4,45,3,43],[4,47,3,45],[5,4,4,2,"value"],[5,9,4,7],[5,11,4,9],[6,2,5,0],[6,3,5,1],[6,4,5,2],[7,2,6,0,"exports"],[7,9,6,7],[7,10,6,8,"runAsync"],[7,18,6,16],[7,21,6,19,"runAsync"],[7,29,6,27],[8,2,7,0],[8,6,7,4,"_WorkletsProxy"],[8,20,7,18],[8,23,7,21,"require"],[8,30,7,28],[8,31,7,28,"_dependencyMap"],[8,45,7,28],[8,81,7,60],[8,82,7,61],[9,2,8,0],[9,6,8,4,"_FrameProcessorsUnavailableError"],[9,38,8,36],[9,41,8,39,"require"],[9,48,8,46],[9,49,8,46,"_dependencyMap"],[9,63,8,46],[9,103,8,82],[9,104,8,83],[10,2,9,0],[10,6,9,4,"_throwErrorOnJS"],[10,21,9,19],[10,24,9,22,"require"],[10,31,9,29],[10,32,9,29,"_dependencyMap"],[10,46,9,29],[10,69,9,48],[10,70,9,49],[11,2,10,0],[12,0,11,0],[13,0,12,0],[14,2,13,0],[14,6,13,4,"isAsyncContextBusy"],[14,24,13,22],[15,2,14,0],[16,0,15,0],[17,0,16,0],[18,2,17,0],[18,6,17,4,"runOnAsyncContext"],[18,23,17,21],[19,2,17,22],[19,8,17,22,"_worklet_14389502829438_init_data"],[19,41,17,22],[20,4,17,22,"code"],[20,8,17,22],[21,4,17,22,"location"],[21,12,17,22],[22,4,17,22,"sourceMap"],[22,13,17,22],[23,2,17,22],[24,2,18,0],[24,6,18,4],[25,4,19,2],[25,10,19,8,"Worklets"],[25,18,19,16],[25,21,19,19,"_WorkletsProxy"],[25,35,19,33],[25,36,19,34,"WorkletsProxy"],[25,49,19,47],[25,50,19,48,"Worklets"],[25,58,19,56],[26,4,20,2,"isAsyncContextBusy"],[26,22,20,20],[26,25,20,23,"Worklets"],[26,33,20,31],[26,34,20,32,"createSharedValue"],[26,51,20,49],[26,52,20,50],[26,57,20,55],[26,58,20,56],[27,4,21,2],[27,10,21,8,"asyncContext"],[27,22,21,20],[27,25,21,23,"Worklets"],[27,33,21,31],[27,34,21,32,"createContext"],[27,47,21,45],[27,48,21,46],[27,68,21,66],[27,69,21,67],[28,4,22,2,"runOnAsyncContext"],[28,21,22,19],[28,24,22,22,"asyncContext"],[28,36,22,34],[28,37,22,35,"createRunAsync"],[28,51,22,49],[28,52,22,50],[28,61,22,50,"reactNativeVisionCamera_runAsyncJs1Factory"],[28,104,22,50],[29,6,22,50,"_worklet_14389502829438_init_data"],[29,39,22,50],[30,6,30,10,"_throwErrorOnJS"],[30,21,30,25],[31,6,37,6,"isAsyncContextBusy"],[32,4,37,24],[33,6,37,24],[33,12,37,24,"_e"],[33,14,37,24],[33,22,37,24,"global"],[33,28,37,24],[33,29,37,24,"Error"],[33,34,37,24],[34,6,37,24],[34,12,37,24,"reactNativeVisionCamera_runAsyncJs1"],[34,47,37,24],[34,59,37,24,"reactNativeVisionCamera_runAsyncJs1"],[34,60,22,51,"frame"],[34,65,22,56],[34,67,22,58,"func"],[34,71,22,62],[34,73,22,67],[35,8,25,4],[35,12,25,8],[36,10,26,6],[37,10,27,6,"func"],[37,14,27,10],[37,15,27,11],[37,16,27,12],[38,8,28,4],[38,9,28,5],[38,10,28,6],[38,17,28,13,"e"],[38,18,28,14],[38,20,28,16],[39,10,29,6],[40,10,30,6],[40,11,30,7],[40,12,30,8],[40,14,30,10,"_throwErrorOnJS"],[40,29,30,25],[40,30,30,26,"throwErrorOnJS"],[40,44,30,40],[40,46,30,42,"e"],[40,47,30,43],[40,48,30,44],[41,8,31,4],[41,9,31,5],[41,18,31,14],[42,10,32,6],[43,10,33,6],[43,16,33,12,"internal"],[43,24,33,20],[43,27,33,23,"frame"],[43,32,33,28],[44,10,34,6,"internal"],[44,18,34,14],[44,19,34,15,"decrementRefCount"],[44,36,34,32],[44,37,34,33],[44,38,34,34],[46,10,36,6],[47,10,37,6,"isAsyncContextBusy"],[47,28,37,24],[47,29,37,25,"value"],[47,34,37,30],[47,37,37,33],[47,42,37,38],[48,8,38,4],[49,6,39,2],[49,7,39,3],[50,6,39,3,"reactNativeVisionCamera_runAsyncJs1"],[50,41,39,3],[50,42,39,3,"__closure"],[50,51,39,3],[51,8,30,10,"_throwErrorOnJS"],[51,23,30,25],[52,8,37,6,"isAsyncContextBusy"],[53,6,37,24],[54,6,37,24,"reactNativeVisionCamera_runAsyncJs1"],[54,41,37,24],[54,42,37,24,"__workletHash"],[54,55,37,24],[55,6,37,24,"reactNativeVisionCamera_runAsyncJs1"],[55,41,37,24],[55,42,37,24,"__pluginVersion"],[55,57,37,24],[56,6,37,24,"reactNativeVisionCamera_runAsyncJs1"],[56,41,37,24],[56,42,37,24,"__initData"],[56,52,37,24],[56,55,37,24,"_worklet_14389502829438_init_data"],[56,88,37,24],[57,6,37,24,"reactNativeVisionCamera_runAsyncJs1"],[57,41,37,24],[57,42,37,24,"__stackDetails"],[57,56,37,24],[57,59,37,24,"_e"],[57,61,37,24],[58,6,37,24],[58,13,37,24,"reactNativeVisionCamera_runAsyncJs1"],[58,48,37,24],[59,4,37,24],[59,5,22,50],[60,6,22,50,"_worklet_14389502829438_init_data"],[60,39,22,50],[61,6,30,10,"_throwErrorOnJS"],[61,21,30,25],[62,6,37,6,"isAsyncContextBusy"],[63,4,37,24],[63,6,39,3],[63,7,39,4],[64,2,40,0],[64,3,40,1],[64,4,40,2],[64,11,40,9,"e"],[64,12,40,10],[64,14,40,12],[65,4,41,2],[66,4,42,2],[67,4,43,2,"isAsyncContextBusy"],[67,22,43,20],[67,25,43,23],[68,6,44,4,"value"],[68,11,44,9],[68,13,44,11],[69,4,45,2],[69,5,45,3],[70,4,46,2,"runOnAsyncContext"],[70,21,46,19],[70,24,46,22,"runOnAsyncContext"],[70,25,46,22],[70,30,46,28],[71,6,47,4],[71,12,47,10],[71,16,47,14,"_FrameProcessorsUnavailableError"],[71,48,47,46],[71,49,47,47,"FrameProcessorsUnavailableError"],[71,80,47,78],[71,81,47,79,"e"],[71,82,47,80],[71,83,47,81],[72,4,48,2],[72,5,48,3],[73,2,49,0],[75,2,51,0],[76,0,52,0],[77,0,53,0],[78,0,54,0],[79,0,55,0],[80,0,56,0],[81,0,57,0],[82,0,58,0],[83,0,59,0],[84,0,60,0],[85,0,61,0],[86,0,62,0],[87,0,63,0],[88,0,64,0],[89,0,65,0],[90,0,66,0],[91,0,67,0],[92,0,68,0],[93,0,69,0],[94,0,70,0],[95,0,71,0],[96,0,72,0],[97,0,73,0],[98,0,74,0],[99,0,75,0],[100,0,76,0],[101,0,77,0],[102,0,78,0],[103,0,79,0],[104,0,80,0],[105,0,81,0],[106,0,82,0],[107,0,83,0],[108,0,84,0],[109,0,85,0],[110,0,86,0],[111,0,87,0],[112,2,51,0],[112,8,51,0,"_worklet_13768994699248_init_data"],[112,41,51,0],[113,4,51,0,"code"],[113,8,51,0],[114,4,51,0,"location"],[114,12,51,0],[115,4,51,0,"sourceMap"],[115,13,51,0],[116,2,51,0],[117,2,51,0],[117,8,51,0,"runAsync"],[117,16,51,0],[117,19,88,0],[117,28,88,0,"runAsync_reactNativeVisionCamera_runAsyncJs2Factory"],[117,80,88,0],[118,4,88,0,"_worklet_13768994699248_init_data"],[118,37,88,0],[119,4,91,6,"isAsyncContextBusy"],[119,22,91,24],[120,4,103,2,"runOnAsyncContext"],[121,2,103,19],[122,4,103,19],[122,10,103,19,"_e"],[122,12,103,19],[122,20,103,19,"global"],[122,26,103,19],[122,27,103,19,"Error"],[122,32,103,19],[123,4,103,19],[123,10,103,19,"runAsync"],[123,18,103,19],[123,30,103,19,"runAsync"],[123,31,88,18,"frame"],[123,36,88,23],[123,38,88,25,"func"],[123,42,88,29],[123,44,88,31],[124,6,91,2],[124,10,91,6,"isAsyncContextBusy"],[124,28,91,24],[124,29,91,25,"value"],[124,34,91,30],[124,36,91,32],[125,8,92,4],[126,8,93,4],[127,8,94,4],[128,6,95,2],[130,6,97,2],[131,6,98,2],[131,12,98,8,"internal"],[131,20,98,16],[131,23,98,19,"frame"],[131,28,98,24],[132,6,99,2,"internal"],[132,14,99,10],[132,15,99,11,"incrementRefCount"],[132,32,99,28],[132,33,99,29],[132,34,99,30],[133,6,100,2,"isAsyncContextBusy"],[133,24,100,20],[133,25,100,21,"value"],[133,30,100,26],[133,33,100,29],[133,37,100,33],[135,6,102,2],[136,6,103,2,"runOnAsyncContext"],[136,23,103,19],[136,24,103,20,"frame"],[136,29,103,25],[136,31,103,27,"func"],[136,35,103,31],[136,36,103,32],[137,4,104,0],[137,5,104,1],[138,4,104,1,"runAsync"],[138,12,104,1],[138,13,104,1,"__closure"],[138,22,104,1],[139,6,91,6,"isAsyncContextBusy"],[139,24,91,24],[140,6,103,2,"runOnAsyncContext"],[141,4,103,19],[142,4,103,19,"runAsync"],[142,12,103,19],[142,13,103,19,"__workletHash"],[142,26,103,19],[143,4,103,19,"runAsync"],[143,12,103,19],[143,13,103,19,"__pluginVersion"],[143,28,103,19],[144,4,103,19,"runAsync"],[144,12,103,19],[144,13,103,19,"__initData"],[144,23,103,19],[144,26,103,19,"_worklet_13768994699248_init_data"],[144,59,103,19],[145,4,103,19,"runAsync"],[145,12,103,19],[145,13,103,19,"__stackDetails"],[145,27,103,19],[145,30,103,19,"_e"],[145,32,103,19],[146,4,103,19],[146,11,103,19,"runAsync"],[146,19,103,19],[147,2,103,19],[147,3,88,0],[148,4,88,0,"_worklet_13768994699248_init_data"],[148,37,88,0],[149,4,91,6,"isAsyncContextBusy"],[149,22,91,24],[150,4,103,2,"runOnAsyncContext"],[151,2,103,19],[152,0,103,19],[152,3]],"functionMap":{"names":["<global>","asyncContext.createRunAsync$argument_0","runOnAsyncContext","runAsync"],"mappings":"AAA;kDCqB;GDiB;sBEO;GFE;AGwC;CHgB"},"hasCjsExports":true},"type":"js/module"}]}